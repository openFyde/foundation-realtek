From 722afd2a85efd45c2108aade5e493ce86e990059 Mon Sep 17 00:00:00 2001
From: yaozenhu <yaozenhu@realtek.com>
Date: Wed, 14 May 2025 03:33:52 -0400
Subject: [PATCH] gpu: drm: add video plane for yocto env

---
 drivers/gpu/drm/realtek/rtk_drm_crtc.c  | 3 +++
 drivers/gpu/drm/realtek/rtk_drm_plane.c | 6 +++---
 2 files changed, 6 insertions(+), 3 deletions(-)

--- a/drivers/gpu/drm/realtek/rtk_drm_crtc.c
+++ b/drivers/gpu/drm/realtek/rtk_drm_crtc.c
@@ -719,6 +719,9 @@
 	{ .layer_nr = VO_VIDEO_PLANE_OSD1,
 	  .type = DRM_PLANE_TYPE_PRIMARY,
 	  .plane_order = 2 },
+	{ .layer_nr = VO_VIDEO_PLANE_V1,
+	  .type = DRM_PLANE_TYPE_OVERLAY,
+	  .plane_order = 1 },
 };
 #endif
 
--- a/drivers/gpu/drm/realtek/rtk_drm_plane.c
+++ b/drivers/gpu/drm/realtek/rtk_drm_plane.c
@@ -534,7 +534,7 @@
 static int rtk_plane_update_video_obj(struct drm_plane *plane)
 {
 	struct rtk_drm_plane *rtk_plane = to_rtk_plane(plane);
-	struct rtk_drm_fence *rtk_fence = rtk_plane->rtk_fence;
+//	struct rtk_drm_fence *rtk_fence = rtk_plane->rtk_fence;
 	struct drm_framebuffer *fb = plane->state->fb;
 	struct drm_gem_object *gem[4];
 	struct rtk_gem_object *rtk_gem[4];
@@ -625,8 +625,8 @@
 
 		index = s->display_idx;
 		obj->context = index;
-		obj->pLock = rtk_fence->pLock_paddr+index;
-		obj->pReceived = rtk_fence->pReceived_paddr+index;
+//		obj->pLock = rtk_fence->pLock_paddr+index;
+//		obj->pReceived = rtk_fence->pReceived_paddr+index;
 		obj->PTSH = decObj->PTSH;
 		obj->PTSL = decObj->PTSL;
 		obj->RPTSH = decObj->RPTSH;
