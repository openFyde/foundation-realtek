From 2e1beffbebb67e1c8e2f45fab5a53ab3d5631b41 Mon Sep 17 00:00:00 2001
From: Edward Wu <edwardwu@realtek.com>
Date: Tue, 23 Jan 2024 07:55:05 +0800
Subject: [PATCH 56/98] dma-buf: heaps: realtek: an option to use Realtek media
 heap without Soc memory protection

Change-Id: I454417d36ffabd2d1d7ad91feea89feb235a71be
---
 drivers/dma-buf/heaps/rtk_protect.c | 33 +++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)

diff --git a/drivers/dma-buf/heaps/rtk_protect.c b/drivers/dma-buf/heaps/rtk_protect.c
index 9d2b84376261..6aa3bb81700c 100644
--- a/drivers/dma-buf/heaps/rtk_protect.c
+++ b/drivers/dma-buf/heaps/rtk_protect.c
@@ -9,6 +9,7 @@
 #include <soc/realtek/rtk_tee.h>
 #include "rtk_protect.h"
 
+#ifdef CONFIG_OPTEE_MEM_API
 static struct tee_mem_device *memdev;
 
 int rtk_protect_create(struct rtk_protect_create_info *info)
@@ -102,3 +103,35 @@ bool rtk_protect_handler_ready(void)
 
 	return memdev != NULL;
 }
+#else
+int rtk_protect_create(struct rtk_protect_create_info *info)
+{
+        return 0;
+}
+
+int rtk_protect_change(struct rtk_protect_change_info *info)
+{
+        return 0;
+}
+
+int rtk_protect_destroy(struct rtk_protect_destroy_info *info)
+{
+        return 0;
+}
+
+int rtk_protect_ext_set(struct rtk_protect_ext_set *info)
+{
+        return 0;
+}
+
+int rtk_protect_ext_unset(struct rtk_protect_ext_unset *info)
+{
+        return 0;
+}
+
+bool rtk_protect_handler_ready(void)
+{
+	pr_warn("%s: use Realtek media heap without Soc memory protection\n", __func__);
+        return 1;
+}
+#endif /* CONFIG_OPTEE_MEM_API */
-- 
2.45.2

