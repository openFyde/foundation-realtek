From 338c1bbb4b3f12023e873df57514b3742a618e65 Mon Sep 17 00:00:00 2001
From: Jyan Chou <jyanchou@realtek.com>
Date: Mon, 14 Aug 2023 18:28:41 +0800
Subject: [PATCH 17/98] Do not need to retune when switching to rpmb partition

Change-Id: I93ac16e05f6f0cac6dbe1f1d249f4200348168b7
---
 drivers/mmc/core/block.c | 4 ++++
 1 file changed, 4 insertions(+)

Index: kernel-5_15/drivers/mmc/core/block.c
===================================================================
--- kernel-5_15.orig/drivers/mmc/core/block.c
+++ kernel-5_15/drivers/mmc/core/block.c
@@ -872,7 +872,9 @@ static int mmc_blk_part_switch_pre(struc
 			if (ret)
 				return ret;
 		}
+#if !IS_ENABLED(CONFIG_MMC_DW_CQE_RTK13XX) && !IS_ENABLED(CONFIG_MMC_DW_CQE_RTK)
 		mmc_retune_pause(card->host);
+#endif
 	}
 
 	return ret;
@@ -886,7 +888,9 @@ static int mmc_blk_part_switch_post(stru
 	int ret = 0;
 
 	if ((part_type & mask) == rpmb) {
+#if !IS_ENABLED(CONFIG_MMC_DW_CQE_RTK13XX) && !IS_ENABLED(CONFIG_MMC_DW_CQE_RTK)
 		mmc_retune_unpause(card->host);
+#endif
 		if (card->reenable_cmdq && !card->ext_csd.cmdq_en)
 			ret = mmc_cmdq_enable(card);
 	}
